# === BLOCK: SCRIPT_WOHNZIMMER_MASTER_BUTTON ===
# Zweck: Master-Button fÃ¼r Wohnzimmerlichter mit intelligenter Schaltlogik
# Status: âœ… Getestet - DELAYS ERFORDERLICH!
# Erstellt: 2025-08-22
# GeÃ¤ndert: 2025-08-23 - HA 2024.10+ Syntax beachtet
# AbhÃ¤ngigkeiten: switch.steckdose_1-5
# Logik: Alle ausâ†’alle an, alle anâ†’alle aus, gemischtâ†’alle aus
# WICHTIG: 0.5s Delay zwischen Schaltungen wegen Stromspitzen!

wohnzimmer_lichter_master:
  alias: "Wohnzimmer Lichter Master"
  description: "Schaltet alle Wohnzimmerlichter intelligent mit 0.5s VerzÃ¶gerung"
  sequence:
    - choose:
        # CASE 1: Alle Lichter sind AUS â†’ Alle einschalten
        - conditions:
            - condition: template
              value_template: >
                {{ is_state('switch.steckdose_1', 'off') and
                   is_state('switch.steckdose_2', 'off') and
                   is_state('switch.steckdose_3', 'off') and
                   is_state('switch.steckdose_4', 'off') and
                   is_state('switch.steckdose_5', 'off') }}
          sequence:
            - action: switch.turn_on
              target:
                entity_id: switch.steckdose_1
            - delay: 
                milliseconds: 500
            - action: switch.turn_on
              target:
                entity_id: switch.steckdose_2
            - delay: 
                milliseconds: 500
            - action: switch.turn_on
              target:
                entity_id: switch.steckdose_3
            - delay: 
                milliseconds: 500
            - action: switch.turn_on
              target:
                entity_id: switch.steckdose_4
            - delay: 
                milliseconds: 500
            - action: switch.turn_on
              target:
                entity_id: switch.steckdose_5
        
        # CASE 2: Alle Lichter sind AN â†’ Alle ausschalten
        - conditions:
            - condition: template
              value_template: >
                {{ is_state('switch.steckdose_1', 'on') and
                   is_state('switch.steckdose_2', 'on') and
                   is_state('switch.steckdose_3', 'on') and
                   is_state('switch.steckdose_4', 'on') and
                   is_state('switch.steckdose_5', 'on') }}
          sequence:
            - action: switch.turn_off
              target:
                entity_id: switch.steckdose_1
            - delay: 
                milliseconds: 500
            - action: switch.turn_off
              target:
                entity_id: switch.steckdose_2
            - delay: 
                milliseconds: 500
            - action: switch.turn_off
              target:
                entity_id: switch.steckdose_3
            - delay: 
                milliseconds: 500
            - action: switch.turn_off
              target:
                entity_id: switch.steckdose_4
            - delay: 
                milliseconds: 500
            - action: switch.turn_off
              target:
                entity_id: switch.steckdose_5

      # DEFAULT CASE: Gemischte ZustÃ¤nde â†’ Alle ausschalten
      default:
        - action: switch.turn_off
          target:
            entity_id: switch.steckdose_1
        - delay: 
            milliseconds: 500
        - action: switch.turn_off
          target:
            entity_id: switch.steckdose_2
        - delay: 
            milliseconds: 500
        - action: switch.turn_off
          target:
            entity_id: switch.steckdose_3
        - delay: 
            milliseconds: 500
        - action: switch.turn_off
          target:
            entity_id: switch.steckdose_4
        - delay: 
            milliseconds: 500
        - action: switch.turn_off
          target:
            entity_id: switch.steckdose_5

# === END BLOCK: SCRIPT_WOHNZIMMER_MASTER_BUTTON ===

# === BLOCK: SCRIPT_KLIMA_ALLE_AUS ===
# Zweck: Alle Klimaanlagen komplett ausschalten 
# Status: ðŸ”„ Neu
# Erstellt: 2025-08-22
# AbhÃ¤ngigkeiten: Alle climate EntitÃ¤ten

klima_alle_aus:
  alias: "Klima Alle AUS"
  description: "Schaltet alle Klimaanlagen aus"
  sequence:
    # Klimaanlagen ausschalten
    - action: climate.turn_off
      target:
        entity_id:
          - climate.buero
          - climate.wohnzimmer
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob

# === END BLOCK: SCRIPT_KLIMA_ALLE_AUS ===

# === BLOCK: SCRIPT_KLIMA_NACHTMODUS ===
# Zweck: SchlafrÃ¤ume auf 22Â°C + niedrigste GeblÃ¤se-Stufe + Oszillation aus + einschalten
# Status: ðŸ”„ Neu
# Erstellt: 2025-08-22
# AbhÃ¤ngigkeiten: climate.schlafzimmer, climate.finn, climate.nele, climate.jacob

klima_nachtmodus:
  alias: "Klima Nachtmodus"
  description: "Setzt SchlafrÃ¤ume auf 22Â°C, leise, Oszillation aus, einschalten"
  sequence:
    # SCHRITT 1: Klimaanlagen einschalten - alle SchlafrÃ¤ume
    - action: climate.turn_on
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # Kurz warten
    - delay: 2
    
    # SCHRITT 2: HVAC-Modus explizit auf heat_cool setzen
    - action: climate.set_hvac_mode
      data:
        hvac_mode: heat_cool
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # Wieder kurz warten
    - delay: 1
    
    # Temperatur auf 22Â°C setzen - alle SchlafrÃ¤ume
    - action: climate.set_temperature
      data:
        temperature: 22
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # TYP 1: GeblÃ¤se auf quiet (Jacob, Nele, Schlafzimmer)
    - action: climate.set_fan_mode
      data:
        fan_mode: quiet
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.nele
          - climate.jacob
    
    # TYP 2: GeblÃ¤se auf low (Finn) + Sleep Preset
    - action: climate.set_fan_mode
      data:
        fan_mode: low
      target:
        entity_id:
          - climate.finn
    
    - action: climate.set_preset_mode
      data:
        preset_mode: sleep
      target:
        entity_id:
          - climate.finn
    
    # TYP 1: Oszillation stopped (Jacob, Nele, Schlafzimmer)
    - action: climate.set_swing_mode
      data:
        swing_mode: stopped
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.nele
          - climate.jacob
    
    # TYP 2: Oszillation off (Finn)
    - action: climate.set_swing_mode
      data:
        swing_mode: 'off'
      target:
        entity_id:
          - climate.finn
    
    # TYP 1: Horizontal auch stoppen (Jacob, Nele, Schlafzimmer)
    - action: climate.set_swing_horizontal_mode
      data:
        swing_horizontal_mode: stopped
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.nele
          - climate.jacob

# === END BLOCK: SCRIPT_KLIMA_NACHTMODUS ===

# === BLOCK: SCRIPT_KLIMA_KOMFORT_MODUS ===
# Zweck: Alle Klimaanlagen auf 23Â°C + GeblÃ¤se auf auto + einschalten
# Status: ðŸ”„ Neu
# Erstellt: 2025-08-22
# AbhÃ¤ngigkeiten: Alle climate EntitÃ¤ten

klima_komfort_modus:
  alias: "Klima Komfort-Modus"
  description: "Setzt alle Klimaanlagen auf 23Â°C, GeblÃ¤se auto, einschalten"
  sequence:
    # SCHRITT 1: Klimaanlagen einschalten - alle
    - action: climate.turn_on
      target:
        entity_id:
          - climate.buero
          - climate.wohnzimmer
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # Kurz warten
    - delay: 2
    
    # SCHRITT 2: HVAC-Modus explizit auf heat_cool setzen
    - action: climate.set_hvac_mode
      data:
        hvac_mode: heat_cool
      target:
        entity_id:
          - climate.buero
          - climate.wohnzimmer
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # Wieder kurz warten
    - delay: 1
    
    # Temperatur auf 23Â°C setzen - alle Klimaanlagen
    - action: climate.set_temperature
      data:
        temperature: 23
      target:
        entity_id:
          - climate.buero
          - climate.wohnzimmer
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # GeblÃ¤se auf auto - alle Klimaanlagen (beide Typen unterstÃ¼tzen auto)
    - action: climate.set_fan_mode
      data:
        fan_mode: auto
      target:
        entity_id:
          - climate.buero
          - climate.wohnzimmer
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # TYP 2: Preset auf none zurÃ¼cksetzen (Finn, BÃ¼ro)
    - action: climate.set_preset_mode
      data:
        preset_mode: none
      target:
        entity_id:
          - climate.finn
          - climate.buero

# === END BLOCK: SCRIPT_KLIMA_KOMFORT_MODUS ===

# === BLOCK: SCRIPT_KLIMA_SCHLAFBOOSTER ===
# Zweck: Phase 1 des Schlafboosters - schnell auf 21Â°C kÃ¼hlen + einschalten
# Status: ðŸ”„ Neu
# Erstellt: 2025-08-22
# AbhÃ¤ngigkeiten: climate.schlafzimmer, climate.finn, climate.nele, climate.jacob

klima_schlafbooster:
  alias: "Klima Schlafbooster"
  description: "Phase 1: 21Â°C + high GeblÃ¤se + Oszillation an + einschalten"
  sequence:
    # Schlafbooster-Modus in Input Boolean aktivieren (fÃ¼r Automation)
    - action: input_boolean.turn_on
      target:
        entity_id: input_boolean.schlafbooster_aktiv
    
    # SCHRITT 1: Klimaanlagen einschalten - alle SchlafrÃ¤ume
    - action: climate.turn_on
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # Kurz warten
    - delay: 2
    
    # SCHRITT 2: HVAC-Modus explizit auf heat_cool setzen
    - action: climate.set_hvac_mode
      data:
        hvac_mode: heat_cool
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # Wieder kurz warten
    - delay: 1
    
    # Temperatur auf 21Â°C setzen - alle SchlafrÃ¤ume
    - action: climate.set_temperature
      data:
        temperature: 21
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # GeblÃ¤se auf high - alle SchlafrÃ¤ume (beide Typen unterstÃ¼tzen high)
    - action: climate.set_fan_mode
      data:
        fan_mode: high
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.finn
          - climate.nele
          - climate.jacob
    
    # TYP 2: Preset auf none (kein sleep beim Booster) - Finn
    - action: climate.set_preset_mode
      data:
        preset_mode: none
      target:
        entity_id:
          - climate.finn
    
    # TYP 1: Oszillation rangefull (Jacob, Nele, Schlafzimmer)
    - action: climate.set_swing_mode
      data:
        swing_mode: rangefull
      target:
        entity_id:
          - climate.schlafzimmer
          - climate.nele
          - climate.jacob
    
    # TYP 2: Oszillation on (Finn)
    - action: climate.set_swing_mode
      data:
        swing_mode: 'on'
      target:
        entity_id:
          - climate.finn

# === END BLOCK: SCRIPT_KLIMA_SCHLAFBOOSTER ===

# === BLOCK: SCRIPT_KLIMA_SCHLAFBOOSTER_PHASE2 ===
# Zweck: Phase 2 des Schlafboosters - automatisch in Schlafmodus wechseln
# Status: ðŸ”„ Neu
# Erstellt: 2025-08-22
# AbhÃ¤ngigkeiten: Wird von Automation aufgerufen

klima_schlafbooster_phase2:
  alias: "Klima Schlafbooster Phase 2"
  description: "Phase 2: Automatisch auf 22Â°C + leise + nach oben"
  sequence:
    # Schlafbooster-Modus deaktivieren
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.schlafbooster_aktiv
    
    # In normalen Nachtmodus wechseln
    - action: script.turn_on
      target:
        entity_id: script.klima_nachtmodus

# === END BLOCK: SCRIPT_KLIMA_SCHLAFBOOSTER_PHASE2 ===